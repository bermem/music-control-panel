<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AI Music Control Panel V2.0</title>

<style>
body{
  background:#0b0b0f;
  color:#ffffff;
  font-family:Arial, sans-serif;
  margin:40px;
}
h1{color:#00ffc3;}
.section{
  border:1px solid #222;
  padding:15px;
  margin-bottom:20px;
  border-radius:8px;
}
select,input,button,textarea{
  background:#15151a;
  color:#ffffff;
  border:1px solid #333;
  padding:8px;
  margin:5px 0;
}
button{cursor:pointer;}
#output{
  white-space:pre-wrap;
  background:#111;
  padding:15px;
  border:1px solid #333;
  margin-top:15px;
  min-height:120px;
}
</style>
</head>

<body>

<h1>ðŸŽ› AI Music Control Panel V2.0</h1>

<div class="section">
<h3>Core Settings</h3>

<input id="songTitle" placeholder="Song Title" />
<input id="customHook" placeholder="Custom Hook Line" />

<br>

<select id="genre">
<option>Modern Pop</option>
<option>EDM Festival</option>
<option>T-POP Ballad</option>
<option>80s Dance Pop</option>
<option>Lo-fi Chill</option>
</select>

<select id="bpm">
<option>90</option>
<option>100</option>
<option>110</option>
<option>120</option>
<option>128</option>
</select>

<select id="key">
<option>C Major</option>
<option>G Major</option>
<option>A Minor</option>
<option>D Major</option>
<option>F Major</option>
</select>

<select id="structure">
<option>Standard (Verse/Chorus)</option>
<option>Extended (Pre + Bridge)</option>
<option>Ultra 6-7 min Algorithm</option>
</select>

<br>
<button onclick="generate()">ðŸŽµ Generate</button>
<button onclick="copyOutput()">ðŸ“‹ Copy</button>
<button onclick="exportTXT()">ðŸ’¾ Export .txt</button>
</div>

<div class="section">
<h3>Presets</h3>
<input id="presetName" placeholder="Preset Name"/>
<button onclick="savePreset()">Save</button>
<select id="presetList"></select>
<button onclick="loadPreset()">Load</button>
</div>

<div class="section">
<h3>History</h3>
<select id="historyList"></select>
<button onclick="loadHistory()">Load</button>
</div>

<div id="output"></div>

<script>

let history = JSON.parse(localStorage.getItem("promptHistoryV2")) || [];
let presets = JSON.parse(localStorage.getItem("promptPresetsV2")) || {};

function generate(){
  const title=document.getElementById("songTitle").value || "Untitled";
  const hook=document.getElementById("customHook").value || "Memorable Repeatable Hook";
  const genre=document.getElementById("genre").value;
  const bpm=document.getElementById("bpm").value;
  const key=document.getElementById("key").value;
  const structure=document.getElementById("structure").value;

  let structureDetail="";
  if(structure.includes("Ultra")){
    structureDetail="Hook repetition x3, dynamic drop, extended outro, algorithm optimized length.";
  }

  const prompt=
`Title: ${title}

Genre: ${genre}
Tempo: ${bpm} BPM
Key: ${key}

Structure: ${structure}
${structureDetail}

Main Hook: "${hook}"

Production Notes:
- Strong intro identity
- Catchy chorus layering
- Emotional lift before final drop`;

  document.getElementById("output").innerText=prompt;

  history.push(prompt);
  localStorage.setItem("promptHistoryV2",JSON.stringify(history));
  updateHistory();
}

function copyOutput(){
  navigator.clipboard.writeText(document.getElementById("output").innerText);
  alert("Copied!");
}

function exportTXT(){
  const text=document.getElementById("output").innerText;
  const blob=new Blob([text],{type:"text/plain"});
  const link=document.createElement("a");
  link.href=URL.createObjectURL(blob);
  link.download="prompt_v2.txt";
  link.click();
}

function savePreset(){
  const name=document.getElementById("presetName").value;
  presets[name]={
    genre:genre.value,
    bpm:bpm.value,
    key:key.value,
    structure:structure.value
  };
  localStorage.setItem("promptPresetsV2",JSON.stringify(presets));
  updatePresetList();
}

function loadPreset(){
  const selected=document.getElementById("presetList").value;
  if(presets[selected]){
    genre.value=presets[selected].genre;
    bpm.value=presets[selected].bpm;
    key.value=presets[selected].key;
    structure.value=presets[selected].structure;
  }
}

function updatePresetList(){
  presetList.innerHTML="";
  for(let key in presets){
    let option=document.createElement("option");
    option.value=key;
    option.text=key;
    presetList.appendChild(option);
  }
}

function updateHistory(){
  historyList.innerHTML="";
  history.forEach((item,index)=>{
    let option=document.createElement("option");
    option.value=index;
    option.text="Prompt "+(index+1);
    historyList.appendChild(option);
  });
}

function loadHistory(){
  const index=historyList.value;
  output.innerText=history[index];
}

updatePresetList();
updateHistory();

</script>

</body>
</html>
